{
	"@version": 1.0, 
	"relink": [
		"// % Create Symbolic links between package folders and public folders.",
		"@sudo on",
		"capture PWD pwd",
		"rm -f {PWD}/public/theme/orange",
		"rm -f {PWD}/public/assets/backorder",
		"rm -f {PWD}/public/assets/stock-status-check",
		"ln -s {PWD}/packages/projectorangebox/theme-orange/public/theme/orange {PWD}/public/theme/orange",
		"ln -s {PWD}/packages/quadratec/backorder/public/assets/backorder {PWD}/public/assets/backorder",
		"ln -s {PWD}/packages/quadratec/stock-status-check/public/assets/stock-status-check {PWD}/public/assets/stock-status-check"
	],
	"copy public": [
		"// % Copy complete folders between package folders and public folders.",
		"@sudo on",
		"capture PWD pwd",
		"cp -R {PWD}/packages/projectorangebox/theme-orange/public/theme/orange {PWD}/public/theme/orange",
		"cp -R {PWD}/packages/quadratec/backorder/public/assets/backorder {PWD}/public/assets/backorder",
		"cp -R {PWD}/packages/quadratec/stock-status-check/public/assets/stock-status-check {PWD}/public/assets/stock-status-check"
	],
	"clear sessions": [
		"// % Delete all files in the session folder.",
		"@sudo on",
		"capture PWD pwd",
		"rm -f {PWD}/var/sessions/*"
	],
	"clear caches": [
		"// % Delete all files in the cache, uploads, downloads folders.",
		"@sudo on",
		"capture PWD pwd",
		"rm -fdr {PWD}/var/cache/*",
		"rm -fdr {PWD}/var/uploads/*",
		"rm -fdr {PWD}/var/downloads/*",
		"rm -fdr {PWD}/var/sessions/*",
		"rm -fdr {PWD}/var/tmp/*"
	],
	"repair": [
		"// % Repair folder permissions.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"mkdir -p {PWD}/packages",
		"mkdir -p {PWD}/bin",
		"mkdir -p {PWD}/support",
		"mkdir -p {PWD}/support/migrations",
		"mkdir -p {PWD}/support/backups",
		"mkdir -p {PWD}/public/assets",
		"mkdir -p {PWD}/public/theme",
		"mkdir -p {PWD}/var",
		"mkdir -p {PWD}/var/cache",
		"mkdir -p {PWD}/var/uploads",
		"mkdir -p {PWD}/var/downloads",
		"mkdir -p {PWD}/var/emails",
		"mkdir -p {PWD}/var/logs",
		"mkdir -p {PWD}/var/sessions",
		"mkdir -p {PWD}/var/tmp",
		"mkdir -p {PWD}/var/scheduler_output_logs",
		"mkdir -p {PWD}/var/xdebug",
		"find {PWD} -type f -print0 | sudo xargs -0 chmod 664",
		"find {PWD} -type d -print0 | sudo xargs -0 chmod 775",
		"find {PWD} -type f -print0 | sudo xargs -0 chown {CHOWN}",
		"find {PWD} -type d -print0 | sudo xargs -0 chown {CHOWN}",
		"find {PWD} -type f -print0 | sudo xargs -0 chgrp {CHGRP}",
		"find {PWD} -type d -print0 | sudo xargs -0 chgrp {CHGRP}",
		"chmod -Rf 777 {PWD}/var",
		"chmod -Rf 777 {PWD}/var/cache/*",
		"chmod -Rf 777 {PWD}/var/uploads/*",
		"chmod -Rf 777 {PWD}/var/downloads/*",
		"chmod -Rf 777 {PWD}/var/emails/*",
		"chmod -Rf 777 {PWD}/var/logs/*",
		"chmod -Rf 777 {PWD}/var/tmp/*",
		"chmod -Rf 777 {PWD}/var/sessions/*",
    "chmod -Rf 777 {PWD}/bin/*.sh",
    "chmod -Rf 777 {PWD}/bin/*.php",
		"chmod -Rf 777 {PWD}/support/backups"
	],
	"git update": [
		"// % Fetch and Reset all git Modules.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"gitx update {PWD}",
		"gitx update {PWD}/packages/quadratec/backorder",
		"gitx update {PWD}/packages/quadratec/stock-status-check",
		"gitx update {PWD}/packages/quadratec/drop-ships",
		"gitx update {PWD}/packages/quadratec/affirm",
		"gitx update {PWD}/packages/quadratec/status-board",
		"gitx update {PWD}/packages/quadratec/gift-certificate",
		"gitx update {PWD}/packages/quadratec/category_mgrs",
		"gitx update {PWD}/packages/quadratec/quad_ldap",
		"gitx update {PWD}/packages/quadratec/vendor-stock",
		"gitx update {PWD}/packages/quadratec/emarsys_order_feed",
		"gitx update {PWD}/packages/quadratec/tapemacs",
		"gitx update {PWD}/packages/quadratec/backorder_emails",
		"gitx update {PWD}/packages/misc/orange_snippets",
		"gitx update {PWD}/packages/misc/masquerade",
		"gitx update {PWD}/packages/misc/opcache",
		"gitx update {PWD}/packages/misc/config-viewer",
		"gitx update {PWD}/packages/misc/login-success",
		"gitx update {PWD}/packages/projectorangebox/extra-validations",
		"gitx update {PWD}/packages/projectorangebox/migrations",
		"gitx update {PWD}/packages/projectorangebox/orange",
		"gitx update {PWD}/packages/projectorangebox/theme-orange",
		"gitx update {PWD}/packages/projectorangebox/extras"
	],
	"git checkout": [
		"// % Checkout GIT repositories if they are not already checked out.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"e 'Using GIT Branch {GITBRANCH}'",
		"gitx checkout git@bitbucket.org:quadratec/application.git {PWD}/~app {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/quadratec-backorder.git {PWD}/packages/quadratec/backorder {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/quadratec-stock-status-check.git {PWD}/packages/quadratec/stock-status-check {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/quadratec-drop-ships.git {PWD}/packages/quadratec/drop-ships {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/affirm.git {PWD}/packages/quadratec/affirm {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/status-board.git {PWD}/packages/quadratec/status-board {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/gift-certificate.git {PWD}/packages/quadratec/gift-certificate {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/category_mgrs.git {PWD}/packages/quadratec/category_mgrs {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/quad_ldap.git {PWD}/packages/quadratec/quad_ldap {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/quadratec-vendor-stock.git {PWD}/packages/quadratec/vendor-stock {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/emarsys_order_feed.git {PWD}/packages/quadratec/emarsys_order_feed {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/tapemacs.git {PWD}/packages/quadratec/tapemacs {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/orange_snippets.git {PWD}/packages/misc/orange_snippets {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/masquerade.git {PWD}/packages/misc/masquerade {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/back_order_emails.git {PWD}/packages/quadratec/backorder_emails {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/projectorangebox-opcache.git {PWD}/packages/misc/opcache {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/projectorangebox-config-viewer.git {PWD}/packages/misc/config-viewer {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/projectorangebox-login-success.git {PWD}/packages/misc/login-success {GITBRANCH}",
		"gitx checkout git@bitbucket.org:quadratec/projectorangebox-extra-validations.git {PWD}/packages/projectorangebox/extra-validations {GITBRANCH}",
		"gitx checkout https://github.com/ProjectOrangeBox/Orange_v2_cli.git {PWD}/packages/projectorangebox/migrations {GITBRANCH}",
		"gitx checkout https://github.com/ProjectOrangeBox/orangev2.git {PWD}/packages/projectorangebox/orange {GITBRANCH}",
		"gitx checkout https://github.com/ProjectOrangeBox/theme-orangev2.git {PWD}/packages/projectorangebox/theme-orange {GITBRANCH}",
		"gitx checkout https://github.com/ProjectOrangeBox/orange_extras.git {PWD}/packages/projectorangebox/extras {GITBRANCH}",
		"rm {PWD}/~app/.env",
		"cp -R {PWD}/~app/.git {PWD}/.git",
		"cp -R {PWD}/~app/* {PWD}",
		"rm -fdr {PWD}/~app"
	],
	"git status": [
		"// % Show the GIT branches of the projects git folders.",
		"capture PWD pwd",
		"gitx status {PWD}",
		"gitx status {PWD}/packages/quadratec/backorder",
		"gitx status {PWD}/packages/quadratec/stock-status-check",
		"gitx status {PWD}/packages/quadratec/drop-ships",
		"gitx status {PWD}/packages/quadratec/affirm",
		"gitx status {PWD}/packages/quadratec/status-board",
		"gitx status {PWD}/packages/quadratec/gift-certificate",
		"gitx status {PWD}/packages/quadratec/category_mgrs",
		"gitx status {PWD}/packages/quadratec/quad_ldap",
		"gitx status {PWD}/packages/quadratec/vendor-stock",
		"gitx status {PWD}/packages/quadratec/emarsys_order_feed",
		"gitx status {PWD}/packages/quadratec/tapemacs",
		"gitx status {PWD}/packages/quadratec/backorder_emails",
		"gitx status {PWD}/packages/misc/orange_snippets",
		"gitx status {PWD}/packages/misc/masquerade",
		"gitx status {PWD}/packages/misc/opcache",
		"gitx status {PWD}/packages/misc/config-viewer",
		"gitx status {PWD}/packages/misc/login-success",
		"gitx status {PWD}/packages/projectorangebox/extra-validations",
		"gitx status {PWD}/packages/projectorangebox/migrations",
		"gitx status {PWD}/packages/projectorangebox/orange",
		"gitx status {PWD}/packages/projectorangebox/theme-orange",
		"gitx status {PWD}/packages/projectorangebox/extras"
	],
	"complete database backup": [
		"// % Backup the entire database.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"capture FILE_DATE 'date +%m%d%y_%H%M'",
		"mkdir -p {PWD}/support/backups",
		"chmod -f 777 {PWD}/support/backups",
		"mysqldump --extended-insert=FALSE --add-drop-table --add-drop-trigger --create-options --password={DBBACKUPPASSWORD} --events --routines --single-transaction --triggers --user={DBBACKUPUSER} --databases {DBBACKUPDATABASE} | gzip -9 > {PWD}/support/backups/{FILE_DATE}.{DBBACKUPDATABASE}.sql.gz"
	],
	"backup database data": [
		"// % Backup only the database data.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"capture FILE_DATE 'date +%m%d%y_%H%M'",
		"mkdir -p {PWD}/support/backups",
		"chmod -f 777 {PWD}/support/backups",
		"mysqldump --extended-insert=FALSE --add-drop-table --password={DBBACKUPPASSWORD} --user={DBBACKUPUSER} --databases {DBBACKUPDATABASE} | gzip -9 > {PWD}/support/backups/{FILE_DATE}.data.{DBBACKUPDATABASE}.sql.gz"
	],
	"import gz database dump": [
		"// % Import a GZIP database Dump.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"readline FILENAME 'Enter Filename: '",
		"e 'Using: {PWD}/support/backups/{FILENAME}'",
		"zcat {PWD}/support/backups/{FILENAME} | mysql --user={DBBACKUPUSER} --password={DBBACKUPPASSWORD} {DBBACKUPDATABASE}"
	],
	"import database dump": [
		"// % Import a Non GZIP database Dump.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"readline FILENAME 'Enter Filename: '",
		"e 'Using: {PWD}/support/backups/{FILENAME}'",
		"cat {PWD}/support/backups/{FILENAME} | mysql --user={DBBACKUPUSER} --password={DBBACKUPPASSWORD} {DBBACKUPDATABASE}"
	],
	"database schema": [
		"// % Dump database table schema.",
		"@sudo on",
		"capture PWD pwd",
		"import ini {PWD}/.env",
		"capture FILE_DATE 'date +%m%d%y_%H%M'",
		"mkdir -p {PWD}/support/backups",
		"chmod -f 777 {PWD}/support/backups",
		"mysqldump --no-data --add-drop-table --add-drop-trigger --create-options --password={DBBACKUPPASSWORD} --events --routines --single-transaction --triggers --user={DBBACKUPUSER} --databases {DBBACKUPDATABASE} | gzip -9 > {PWD}/support/backups/{FILE_DATE}.{DBBACKUPDATABASE}.schema.sql.gz"
	],
	"migrate": [
		"// % Run migration Up.",
		"capture PWD pwd",
		"@stdout on",
		"cd {PWD}/public;php index.php cli/migrate/up",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/backorder",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/stock-status-check",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/drop-ships",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/affirm",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/status-board",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/gift-certificate",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/category_mgrs",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/quad_ldap",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/vendor-stock",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/emarsys_order_feed",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/tapemacs",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/quadratec/backorder_emails",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/misc/orange_snippets",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/misc/masquerade",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/misc/opcache",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/misc/config-viewer",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/misc/login-success",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/projectorangebox/extra-validations",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/projectorangebox/migrations",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/projectorangebox/orange",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/projectorangebox/theme-orange",
		"cd {PWD}/public;php index.php cli/migrate/up /packages/projectorangebox/extras"
	],
	"site up": [
		"// % Site Up.",
		"@sudo on",
		"capture PWD pwd",
		"chmod -f 777 {PWD}/public",
		"rm {PWD}/public/index.html",
		"chmod -f 775 {PWD}/public"
	],
	"site down": [
		"// % Site Down.",
		"@sudo on",
		"capture PWD pwd",
		"chmod -f 777 {PWD}/public",
		"cp {PWD}/support/site_down.html {PWD}/public/index.html",
		"chmod -f 775 {PWD}/public"
	],
	"backup .env": [
		"// % Site Down.",
		"capture PWD pwd",
		"cp {PWD}/.env {PWD}/.env.backup"
	],
	"composer update": [
		"// % Run composer update",
		"capture PWD pwd",
		"cd {PWD};composer update"
	],
	"setup": [
		"// % Setup a brand new install.",
		"task 'git checkout'",
		"task 'composer update'",
		"task repair",
		"task relink",
		"task 'git status'"
	],
	"complete": [
		"// % Run Complete Site Update.",
		"task 'complete database backup'",
		"task 'site down'",
		"task 'git update'",
		"task repair",
		"task 'clear caches'",
		"task 'clear sessions'",
		"task relink",
		"task 'site up'",
		"task 'composer update'",
		"task 'git status'"
	],
	"quick update": [
		"// % Run Basic Site Update.",
		"task 'backup database data'",
		"task 'git update'",
		"task repair",
		"task 'clear caches'",
		"task relink",
		"task 'git status'"
	]
}