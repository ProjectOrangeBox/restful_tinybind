var router={routes:[],mode:null,root:"/",config:function(e){return this.mode=e&&e.mode&&"history"==e.mode&&history.pushState?"history":"hash",this.root=e&&e.root?"/"+this.clearSlashes(e.root)+"/":"/",this},getFragment:function(){var e="";if("history"===this.mode)e=(e=this.clearSlashes(decodeURI(location.pathname+location.search))).replace(/\?(.*)$/,""),e="/"!=this.root?e.replace(this.root,""):e;else{var r=window.location.href.match(/#(.*)$/);e=r?r[1]:""}return this.clearSlashes(e)},clearSlashes:function(e){return e.toString().replace(/\/$/,"").replace(/^\//,"")},add:function(e,r){return"function"==typeof e&&(r=e,e=""),this.routes.push({re:e,handler:r}),this},remove:function(e){for(var r,t=0;this.routes.length,r=this.routes[t];t++)if(r.handler===e||r.re.toString()===e.toString())return this.routes.splice(t,1),this;return this},flush:function(){return this.routes=[],this.mode=null,this.root="/",this},check:function(e){for(var r=e||this.getFragment(),t=0;t<this.routes.length;t++){var o=r.match(this.routes[t].re);if(o)return o.shift(),this.routes[t].handler.apply({},o),this}return this},listen:function(){var e=this,r=e.getFragment();return clearInterval(this.interval),this.interval=setInterval(function(){r!==e.getFragment()&&(r=e.getFragment(),e.check(r))},50),this},navigate:function(e){return e=e||"","history"===this.mode?history.pushState(null,null,this.root+this.clearSlashes(e)):window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+e,this}},app={id:"#app",local:{},error:!1,errors:{},record:{},records:[{}],page:{},form:{},_layouts:[],bound:void 0,init(){app.helpers.route()},events:{},addEvent(e,r){return app.events[e]=r,this},helpers:{defaultResponse:{200:function(e,r,t){console.log(e,r,t),alert("200 (ok) handler")},201:function(e,r,t){console.log(e,r,t),alert("201 (created) handler")},202:function(e,r,t){console.log(e,r,t),alert("202 (accepted) handler")},401:function(e,r,t){console.log(e,r,t),alert("401 (unauthorized) handler")},404:function(e,r,t){console.log(e,r,t),alert("404 (not found) handler")},406:function(e,r,t){console.log(e,r,t),alert("406 (not accepted) handler")},409:function(e,r,t){console.log(e,r,t),alert("409 (conflict) handler")},500:function(e,r,t){console.log(e,r,t),alert("500 (server error) handler")}},ajax(e,r,t,o){jQuery.ajax({method:e,url:r,data:t,dataType:"json",cache:!1,timeout:5e3,async:!0,statusCode:Object.assign(app.helpers.defaultResponse,o)})},getHandlers:()=>app.helpers.defaultResponse,setData(e){var r=["error","errors","record","records"];for(var t in r)app[r[t]]=e[r[t]];r=["page","form"];for(var t in r)if(e[r[t]])for(key2 in e[r[t]])app[r[t]][key2]=e[r[t]][key2]},getData:()=>({error:app.error,errors:app.errors,record:app.record,records:app.records,page:app.page,form:app.form}),load(e,r){app.helpers.defaultResponse[200]=app.helpers.default200,app._layouts[e]?(jQuery("body").trigger("unbound"),jQuery(app.id).html(app._layouts[e]),app.helpers.ajax("get",r,{},app.helpers.getHandlers())):jQuery.get(e,function(t){app._layouts[e]=t,jQuery("body").trigger("unbound"),jQuery(app.id).html(app._layouts[e]),app.helpers.ajax("get",r,{},app.helpers.getHandlers())})},default200(e,r,t){app.helpers.setData(e),app.bound=tinybind.bind(document.querySelector(app.id),app),jQuery("body").trigger("bound")},form201(e,r,t){app.helpers.load("index","/rest/indexModel")},form202(e,r,t){app.helpers.load("index","/rest/indexModel")},form406(e,r,t){if((app=Object.assign(app,e.responseJSON)).error){notify.removeAll();for(const e in app.errors)for(const r in app.errors[e])notify.addError(app.errors[e][r])}},route(){router._routerSetup||(router.config({mode:"history"}),router._routerSetup=!0,router.listen()),router.check(window.location.pathname)}}};document.addEventListener("DOMContentLoaded",function(){app.init()});
//# sourceMappingURL=grape.min.js.map